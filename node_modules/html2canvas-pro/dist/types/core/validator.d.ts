/**
 * Input Validator
 *
 * Provides validation and sanitization for user inputs to prevent security vulnerabilities
 * including SSRF, XSS, and injection attacks.
 */
/**
 * Validation result
 */
export interface ValidationResult {
    valid: boolean;
    error?: string;
    sanitized?: any;
    /**
     * Indicates if runtime validation is recommended
     * (e.g., for proxy URLs to prevent DNS rebinding attacks)
     */
    requiresRuntimeCheck?: boolean;
}
/**
 * Validator configuration
 */
export interface ValidatorConfig {
    /**
     * Allowed proxy domains for SSRF prevention
     * If empty, no domain restrictions
     */
    allowedProxyDomains?: string[];
    /**
     * Allow localhost/127.0.0.1 as proxy URL. Only set for development or test (e.g. Karma reftests).
     * @default false
     */
    allowLocalhostProxy?: boolean;
    /**
     * Maximum allowed image timeout in milliseconds
     */
    maxImageTimeout?: number;
    /**
     * Whether to allow data URLs
     */
    allowDataUrls?: boolean;
    /**
     * Custom validation function
     */
    customValidator?: (value: any, type: string) => ValidationResult;
}
/**
 * Input Validator
 *
 * Validates and sanitizes user inputs for security and correctness.
 */
export declare class Validator {
    private readonly config;
    constructor(config?: ValidatorConfig);
    /**
     * Validate a URL
     *
     * @param url - URL to validate
     * @param context - Context for validation (e.g., 'proxy', 'image')
     * @returns Validation result
     */
    validateUrl(url: string, context?: 'proxy' | 'image' | 'general'): ValidationResult;
    /**
     * Check if a hostname is a private IP address
     */
    private isPrivateIP;
    /**
     * Check if an IPv6 address is private or special
     * Handles compressed IPv6 addresses (e.g., ::1, fc00::1)
     */
    private isPrivateIPv6;
    /**
     * Expand compressed IPv6 address to full form
     * e.g., "::1" -> "0000:0000:0000:0000:0000:0000:0000:0001"
     */
    private expandIPv6;
    /**
     * Fallback prefix matching for IPv6 when expansion fails
     */
    private isPrivateIPv6Prefix;
    /**
     * Validate CSP nonce
     *
     * @param nonce - CSP nonce to validate
     * @returns Validation result
     */
    validateCspNonce(nonce: string): ValidationResult;
    /**
     * Validate image timeout
     *
     * @param timeout - Timeout in milliseconds
     * @returns Validation result
     */
    validateImageTimeout(timeout: number): ValidationResult;
    /**
     * Validate window dimensions
     *
     * @param width - Window width
     * @param height - Window height
     * @returns Validation result
     */
    validateDimensions(width: number, height: number): ValidationResult;
    /**
     * Validate scale factor
     *
     * @param scale - Scale factor
     * @returns Validation result
     */
    validateScale(scale: number): ValidationResult;
    /**
     * Validate HTML element
     *
     * @param element - Element to validate
     * @returns Validation result
     */
    validateElement(element: any): ValidationResult;
    /**
     * Validate entire options object
     *
     * @param options - Options to validate
     * @returns Validation result with all errors
     */
    validateOptions(options: any): ValidationResult;
}
/**
 * Create a default validator instance
 */
export declare function createDefaultValidator(config?: ValidatorConfig): Validator;
/**
 * Create a strict validator with security-focused settings
 */
export declare function createStrictValidator(allowedProxyDomains: string[]): Validator;
